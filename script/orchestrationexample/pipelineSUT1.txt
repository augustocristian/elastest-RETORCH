node{
    def sutIp
    elastest(tss: ['EUS'], surefireReportsPattern: '**/target/surefire-reports/TEST-*.xml', monitoring: true, project: 'UserTest') {
        stage("Setting environment") {
            echo 'Environment variables'
            sh "env"
            git "https://github.com/augustocristian/elastest-RETORCH.git"
            checkout([$class: 'GitSCM', branches: [[name: '*/2_MSC_Dissertation']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[url: 'https://github.com/augustocristian/elastest-RETORCH.git']]])
        }
        	stage("Run Tests") {
                echo 'Running test'
                mvnHome = tool 'M3.3.9'
                sh "'${mvnHome}/bin/mvn' -Dapp.url=https://" + sutIp +":5001/ -Dtest=TestExecutor#testTestCasesFormat -B -DforkCount=0 test"
                step([$class: 'JUnitResultArchiver', testResults: '**/target/surefire-reports/TEST-*.xml'])
         
        	}
    } 
    }